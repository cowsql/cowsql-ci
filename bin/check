#!/bin/sh
set -eu

cd "$(dirname "${0}")"

testbed=

usage() {
	USAGE_STRING="\
usage: $0 [options]

Run cowsql checks

  -t, --testbed=TESTBED  specify the environment the checks are run on
  -h, --help             display this help message and exit"

	case "$1" in
		out)
			echo "$USAGE_STRING"
			exit 0
			;;
		err)
			echo "$USAGE_STRING" >&2
			exit 1
			;;
	esac
}

if ! temp=$(getopt -o 't:h' --long 'testbed:,help' -n "$0" -- "$@"); then
	exit 1
fi

eval set -- "$temp"
unset temp

while true; do
    case "$1" in
    -t | --testbed)
        testbed="$2"
        shift 2
        ;;
    -h| --help)
        usage out
        ;;
    --)
        shift
        break
        ;;
    *)
        usage err
        ;;
    esac
done

case "${testbed}" in
    lxc)
        . ../lib/lxc.sh
        ;;
    *)
        echo "unknown testbed: \"${testbed}\""
        exit 1
        ;;
esac
